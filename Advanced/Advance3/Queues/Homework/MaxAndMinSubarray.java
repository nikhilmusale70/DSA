package Queues.Homework;

import java.util.Deque;
import java.util.LinkedList;
import java.util.Queue;

public class MaxAndMinSubarray {
    public static void main(String[] args) {
        MaxAndMinSubarray obj = new MaxAndMinSubarray();
        int[] A = {-24020,-17323,-13684,-25299,-11692,1032,-19092,25535,241,5764,-20570,-5186,-18585,2239,-32340,3430,-13037,12361,-13222,-27750,-13321,30505,-10119,-1843,-24159,30810,-27073,-28913,-2867,27721,-13109,-20087,-21280,-25944,1620,31443,-22162,-23646,-8103,31684,22091,3365,13896,-17982,-7135,-8938,-3175,-21225,-12855,13537,-20422,-674,-28177,4782,-19005,21241,-18046,24813,25143,25265,-32099,-1451,-27443,-17988,-6136,25835,17988,11356,-10060,27938,-21137,21082,-24768,-29627,11734,18643,1671,24979,-17633,-2062,8237,12158,-13334,-21640,781,12993,30699,-29552,10968,-14742,28012,-12075,25109,-30635,8889,-11217,15004,-17058,30595,-2990,22042,7827,3475,-25538,-32400,-6790,2371,-66,3795,31994,8706,30996,11022,16480,-724,5719,-18747,-24480,31440,-1241,2478,-29331,32161,-23198,24459,-6792,29702,-27488,2378,-16063,23634,-27914,-22842,-6385,-15084,-27707,19963,4550,23247,-4297,-31491,27997,-24075,12860,-16666,-18376,-7746,-15439,22238,-24973,-23853,25458,8511,-15398,-17685,10571,23556,1666,-14682,-12592,-4676,22914,30447,-25774,26350,-17532,1244,26630,-11586,-10683,-29882,24234,20821,-27390,29499,-32708,-4241,-26101,10400,31408,-563,16583,26944,11133,28619,-1678,-13832,8048,32192,5081,3317,27009,-9161,21289,-2460,18140,-30069,-18805,-21923,-4961,-15012,-29350,26949,-3620,22539,-28187,-7122,-28142,1972,31527,1068,17850,24955,17806,10571,-14649,-13203,524,698,335,-11007,-23245,18712,16532,19481,11254,5784,10195,-15119,4123,22401,-27278,21601,15558,-2735,888,-5476,-12023,-21008,-18681,21698,10142,21288,20910,19191,-30754,-26509,-10471,27350,-7902,-7532,21287,2562,13215,-2050,-8871,22901,9256,-24612,-23508,-11772,16558,29879,10700,6329,6235,27448,-25317,20384,-9679,20534,-7462,26107,-19355,-30675,4811,21734,-8388,-11847,22213,-21460,3398,-14429,-22840,-264,-13966,-9203,-15356,23068,-15359,-26750,30493,-1149,-17262,22404,19803,26093,21926,23841,-4267,-3328,-2789,4227,-14003,27039,-1884,5229,15697,21897,-18355,-18360,-24341,27853,-15747,17869,6083,13905,-15322,14124,30931,7246,13243,29160,19952,-13521,16540,27177,4476,-23100,-1254,-29352,-12554,5059,22136,-19767,8674,19951,-15139,2871,17793,-25374,-13615,15903,7702,-29697,24534,30716,-21255,4125,-23492,7148,1386,-11851,-2973,32417,-29836,30008,8310,-22244,-29294,-21478,30299,-32271,-10306,27177,-16584,-146,-10994,-16682,-1840,32367,-24474,-21479,29049,23487,12297,-26545,25725,16683,3908,-13485,-28299,-27762,19971,24148,996,-20714,-16178,15347,-2879,2039,-11377,28971,14917,4502,6804,22130,16917,25813,24100,12688,-19393,-20567,32732,15907,-17616,-10965,28973,-1564,31674,-21400,4282,-2624,-3183,769,-32477,-15015,7376,-27393,-16928,16192,-26932,-10145,15301,-4172,8420,32635,27711,24286,4768,-29759,1974,-19810,10520,-9007,-23175,30738,14195,30115,32193,-19842,-5580,-8581,-23466,14102,3504,-31190,-1080,4487,5793,3880,20888,-30049,-25238,8226,23722,-20360,-14969,-23040,-16771,18862,-10920,26896,-13290,-734,-32628,22837,-25564,-6133,-4517,18024,12808,31780,-25331,23858,13395,8559,-2703,11059,2644,28977,29080,-16286,473,5270,24486,-7099,-2913,3359,-22339,29540,32416,-7457,-17005,15752,-12031,70,28437,-5291,-20505,-29707,23459,-26468,10815,-4160,21360,30941,7925,-28556,23370,12631,-32114,10214,28148,16036,-10020,4893,2211,-1194,-1065,-26449,-1922,-24039,18391,8055,21039,11240,1333,13273,22588,-14288,-4992,-8852,23983,-25303,-17064,18456,-6018,-9928,24528,1964,-6179,26242,-2513,17383,-3061,-3704,21943,10040,-17870,-1330,17219,15455,-7031,-27593,359,-22257,4655,11886,717,19416,23336,25828,-25169,-31184,8200,-770,6018,-8684,8041,-22834,-31525,-4111,-6490,25845,7089,4979,3036,-29020,25044,-18214,16229,-1936,-1261,-10887,-9057,12107,-20368,2510,-31404,32605,-13318,-13953,22553,32296,-12490,4096,27374,21028,1293,23546,7013,16987,13618,-28405,30509,1774,24403,-9418,-28135,-27023,-24506,-10535,23978,13829,-17769,-4108,28544,31404,5779,15950,17382,-6386,25888,-8726,28495,9690,13101,15203,-18082,6781,-10121,29828,31671,-21636,4665,-19103,2526,-26287,16630,-17965,29272,-14674,-9130,17275,-18652,-31442,16630,-2859,-4116,-24620,31406,15025,-26141,13678,-8795,31959,267,15932,-23993,-4665,31586,-26189,-23351,10697,28830,-16876,-22138,-2380,-27052,24183,27866,1499,6510,25315,-16866,-19555,-26940,54,-29652,-31270,21853,-12811,-24611,1335,6546,-20242,14328,29954,-11660,-27022,25774,27330,-4464,32725,-15446,31241,27226,31955,-1587,-20796,-28375,-2183,-20287,12820,9066,10372,3748,-14878,26376,-12401,6724,-31547,-20380,650,27442,-25633,22148,8221,12854,-30937,21778,2574,15437,23359,20747,-29012,-10022,-9093,6443,-14201,-26022,-2223,12704,-16158,5221,-22808,4235,-3188,7727,17132,10882,13764,-12421,27821,-20240,-9192,-25,-23982,21811,-8912,23893,-13979,-6109,-16894,6356,14831,-17012,-1290,14311,9339,-27986,25631,-30994,21990,-2630,7292,-10381,-18728,8465,-20724,-17604,23822,-23529,31342,-29399,-27833,-25593,10341,17178,14367,3551,-4457,17813,-7304,-22061,29597,28293,7442,-11754,-17719,19162,-15149,5902,-13572,1208,-7968,-4361,31457,14326,-4227,-21820,30786,5793,16066,-25469,10415,-23930,22944,-24216,25154,6260,-31154,-14537,-26154,-14135,-22752,12355,16683,29088,23272,-7085,-31772,31806,26075,1695,-7272,-3286,-2717,7721,29837,12000,32105,27980,17568,26632,-24138,-27007,10951,-11438,-20899,20268,25533,9319,-26793,-20016,23378,15994,-23012,1630,3305,5731,2482,-21501,-13304,-10323,-25283,-27717,-19595,21934,32413,18918,-25537,14732,7706,-27010,14413,-19768,-29158,22062,-10999,-23732,-13057,1525,32536,19251,2883,1620,27426,10142,19923,-30911,30997,-4368,-32686,24346,14091,27482,-12327,-14401,-14254,-25471,8545,27777,-25276,17464,-16598,2589,5514,-6770,28628,20938,-4989,10699,-7163,-4915,18067,-12569,10176,-22902,-20440,32483,-8941,-26532,26609,21990,21278,-1349,-3989,8593,-3142,-6866,-4111,-31369,22824,7737,19390,31526,29662,20317,24213,-25588,-3670,-17555,3739,-4148,-27343,18214,3180,-14936,-17505,-32724,950,-4234,1906,29519,-31677,-6437,-23106,20157,2007,26426,-30048,-1080,18416,7949,19506,-14158,14600,-19094,-1393,31106,-21936,32256,17323,22218,1681,19501,-15807,12815,-25317,2864,-10084,-29104,-16635,-26834,27043,-31743,-5815,-20238,-11096,-962,-10768,6292,10677,9395,-4497,5450,-24767,20481,-1240,24262,-976,2253,32026,31957,17939,28846,-9629,-23032,29450,-9261,7229,-2018,22283,-26441,-487,-21499,-30655,8692,-23329,11231,7330,-11413,-16512,-20960,-10118,-27780,24368,-24960,15632,-16529,-18800,-9208,-15673,15741,-5908,-13492,3022,-14975,-22017,-30164,-10481,-11712,19124,-21676,-6550,-22752,-187,-24133,-8198,17775,11066,9178,17503,4468,-21864,28508,11538,3050,-25359,-18415,-18276,8510,-24848,18027,-16366,-6098,-9692,14811,19229,7293,-16892,-7169,15794,7945,-16522,21968,30019,-32435,-14262,21489,-4281,-1711,-10562,-27455,-30928,15009,-13062,-3402,-14489,-29477,-3949,19672,9723,19016,-26102,12895,-23086,22541,27572,24716,31295,-16105,-21454,-2240,-20367,2119,-4096,12173,-12372,20740,-24856,16702,14358,-17908,-14202,-30284,-20531,-28763,-25500,2025,2140,21109,-5771,-13433,-16150,21488,-12900,-5140,6713,-32364,27355,-15622,-20340,2562,13752,14416,-15559,-14777,-2901,-17956,-20744,-2066,30497,-29292,-17503,9086,-30752,31043,8394,-15075,12649,31610,6810,6683,-27303,-789,-14579,5748,24729,22475,20048,19249,-26002,-9098,16637,9736,20985,26353,-9115,17314,-17609,-15828,-7583,7198,13330,29627,-9171,32654,19830,-26723,-212,25208,-9902,-17468,11667,31318,-15875,31977,-31188,10774,-19157,10691,1202,16027,-24087,-10326,-1304,31547,-21201,-4323,-25161,-30271,3741,31453,-7258,17766,-4650,4460,-1203,-31330,22972,30700,18065,-28506,3497,-32366,16263,-25446,734,9782,-10232,-26390,2904,30268,-2975,-6379,5804,8108,4615,12764,-8832,29286,-5907,25042,31503,-8575,-4984,-31788,-19369,22461,21821,29756,-32560,7199,-2114,10697,-28828,1619,-3766,-1419,-27512,17213,10656,-26034,-31843,-26999,29015,23135,-4496,7627,7689,12841,27462,1979,8248,22170,-23649,5626,2361,-30895,23247,4849,17331,-3420,24596,-2362,-7206,6661,-6598,30760,6497,20742,27154,22589,-9482,-32300,-14389,28595,1051,17209,4356,-30452,8031,-9316,5988,-3361,-7161,25815,-17618,-31887,-17373,-13104,31197,20293,15956,9728,24231,-13183,-6269,-2127,-4968,-12335,-7623,-30230,-12523,-10615,120,18627,-6414,13616,21033,21433,-5958,16229,19528,28877,20761,-32472,26772,23754,1699,-14717,18852,25581,8978,22779,29537,24170,-7465,20270,-21383,-31974,-10177,19111,6696,25851,-12867,15145,-25129,-7607,-14639,-9774,-10691,-19485,-26264,19296,6916,-16290,678,-6433,-9291,20145,13330,-28932,-24783,-808,4270,-15441,20761,5849,-32219,20613,25477,16394,-24848,-9168,-19653,19957,-8282,-20885,-12382,-5449,29399,-28397,-6441,11431,-313,-12068,-16851,31013,-22089,22587,-11613,-2766,8033,-1892,-3997,-18720,-15601,17801,-1468,28558,-8956,-27590,-7862,23036,2456,-22506,-13277,8517,-28017,28922,4437,-1976,24646,-31662,28313,13718,-10602,-16114,14069,17813,-13892,30822,-8715,8545,23248,-8414,-7246,-11798,25116,-227,32650,-18631,-28364,5424,7002,-4858,-11158,-17206,-3503,3882,-19398,23960,27472,3396,-23484,30896,-14421,-26410,24937,-3848,-12459,3379,19670,-30178,-24723,-25256,-14493,8625,-3363,27209,-31342,-15005,-27843,17094,907,-259,-12209,29510,4428,-499,-22654,2020,11675,-7088,-25742,32301,32633,21043,17564,-419,27512,29608,9524,30781,1087,3312,-1847,24293,19210,-11805,10331,30200,16423,32505,-15272,-15818,-17273,-9088,29180,-17183,-17657,-28769,21127,-15283,-17712,-28545,-25424,-29363,9662,-13432,8622,-1346,-18902,274,19152,28405,-1728,14798,29750,26199,-25686,10851,29750,2406,11655,6710,6776,23059,20695,12518,14457,-2758,-4317,-10944,-31244,-6872,1219,23883,3540,17175,26826,3005,7628,12870,-16068,-2948,-6080,-6554,-16024,-14527,-17873,2366,5825,15041,-14068,7376,-31951,-6293,30579,-30690,-3556,7541,6507,-4730,-32568,3409,3404,21906,7830,10574,-19036,-1944,-8925,-1092,18229,2287,19584,10048,16962,24684,-22023,-1536,23110,6107,-13451,-17273,30421,26744,10301,-18004,217,-14198,-7392,-7533,27407,-25211,-23115,-13395,-2695,23585,-1256,-22475,16167,-6262,28216,-2637,27689,-18813,13644,10372,16536,-27564,-14157,24018,-20439,-8812,-20469,-26827,31258,-25757,27156,12213,-9451,-30991,-24588,-9486,-17318,-17161};
        int B = 687;
        System.out.println(obj.solve(A,B));
    }
    public int solve(int[] A, int B) {
        return greatestAndSmallestSum(A,B);
    }
    int greatestAndSmallestSum(int[] A, int B){
        long mod = 1000000007;
        Deque<Integer> greatesNumberQ = new LinkedList<>();
        Deque<Integer> smallestNumberQ = new LinkedList<>();

        //for first window this is max
        for(int i=0; i<B; i++){
            while(!greatesNumberQ.isEmpty() && greatesNumberQ.getLast()<A[i]){
                greatesNumberQ.removeLast();
            }
            greatesNumberQ.add(A[i]);

            while(!smallestNumberQ.isEmpty() && smallestNumberQ.getLast()>A[i]){
                smallestNumberQ.removeLast();
            }
            smallestNumberQ.add(A[i]);
        }
        System.out.println(" max: "+greatesNumberQ.peek() + " min: "+smallestNumberQ.peek());

        long ans = ((long)greatesNumberQ.getFirst()+(long)smallestNumberQ.getFirst())%mod;
        //each iteration is now a window
        for (int i=B; i<A.length; i++){
            //for greater
            if(A[i-B]==greatesNumberQ.getFirst()){
                greatesNumberQ.removeFirst();
            }
            while(!greatesNumberQ.isEmpty() && greatesNumberQ.getLast()<A[i]){
                greatesNumberQ.removeLast();
            }
            greatesNumberQ.add(A[i]);

            //for smaller
            if(A[i-B]==smallestNumberQ.getFirst()){
                smallestNumberQ.removeFirst();
            }
            while(!smallestNumberQ.isEmpty() && smallestNumberQ.getLast()>A[i]){
                smallestNumberQ.removeLast();
            }
            smallestNumberQ.add(A[i]);

            System.out.println("For I; "+i+ " max: "+greatesNumberQ.peek() + " min: "+smallestNumberQ.peek());

            long sum = ((long)greatesNumberQ.getFirst() + (long)smallestNumberQ.getFirst() + mod)%mod;
            ans = (sum + ans)%mod;
        }

        return (int) ans;
    }
}
